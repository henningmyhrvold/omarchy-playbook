---
# Omarchy Workstation Playbook
# Layers on top of Omarchy — never modifies ~/.local/share/omarchy/
# All roles are self-contained and can be run independently
#
# Usage examples:
#   ./bootstrap.sh                              # Run everything
#   ansible-playbook playbook.yml --tags zsh   # Run only zsh role
#   ansible-playbook playbook.yml --tags "zsh,go"  # Run multiple
#   ansible-playbook playbook.yml --skip-tags mcp  # Skip MCP roles

- hosts: workstation
  become: true
  vars_files:
    - config.yml

  roles:
    # Core packages (your additions on top of Omarchy)
    - { role: pacman, tags: ["pacman", "packages"] }
    - { role: aur, tags: ["aur", "packages"] }
    - { role: aur_packages, tags: ["aur-packages", "packages"] }

    # Shell (installs zsh + oh-my-zsh + p10k — does NOT chsh)
    - { role: zsh, tags: ["zsh", "shell"] }

    # Development tools
    - { role: vscode, tags: ["vscode", "dev", "editor"] }
    - { role: go, tags: ["go", "dev"] }

    # System services
    - { role: dns, tags: ["dns", "network"] }
    - { role: nftables, tags: ["nftables", "firewall"] }
    - { role: wireguard, tags: ["wireguard", "vpn"] }

    # Containers
    - { role: docker_engine, tags: ["docker"] }

    # AI Tools
    - { role: claude_code, tags: ["claude-code", "ai"] }
    - { role: openai_codex, tags: ["openai-code", "ai"] }
    - { role: gemini_cli, tags: ["gemini-cli", "ai"] }
    - { role: pi_coding_agent, tags: ["pi-coding-agent", "ai"] }
    - { role: skills, tags: ["skills", "ai"] }

    # MCP Servers (Docker-based)
    - { role: mcp_filesystem, tags: ["mcp", "mcp-filesystem"], when: mcp_filesystem_enabled | default(true) }
    - { role: mcp_ref, tags: ["mcp", "mcp-ref"], when: mcp_ref_enabled | default(true) }
    - { role: docker_mcp, tags: ["mcp", "docker-mcp"] }

    # Utility (dotfiles, folders, extra links)
    - { role: folders, tags: ["folders"] }
    - { role: dotfiles, tags: ["dotfiles"] }
    - { role: links, tags: ["links"] }
    - { role: omarchy_monitor_settings, tags: ["omarchy-monitor"] }
