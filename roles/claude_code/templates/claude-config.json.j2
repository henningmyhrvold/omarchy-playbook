{
  "projects": {},
  "mcpServers": {
{%- set containers = _mcp_containers.stdout_lines | default([]) -%}
{%- set servers = [] -%}
{%- for container in containers -%}
  {%- if container == 'mcp-filesystem' -%}
    {%- set _ = servers.append({
      'name': 'filesystem',
      'config': {
        'type': 'stdio',
        'command': 'docker',
        'args': ['exec', '-i', container, 'npx', '@modelcontextprotocol/server-filesystem'] + (mcp_filesystem_allowed_dirs | default([])),
        'env': {}
      }
    }) -%}
  {%- elif container == 'mcp-ref' -%}
    {%- set _ = servers.append({
      'name': 'ref',
      'config': {
        'type': 'stdio',
        'command': 'docker',
        'args': ['exec', '-i', container, 'npx', '@upstash/context7-mcp'],
        'env': {}
      }
    }) -%}
  {%- elif container == 'mcp-mcp-docker-1' -%}
    {%- set _ = servers.append({
      'name': 'docker',
      'config': {
        'type': 'stdio',
        'command': 'docker',
        'args': ['exec', '-i', container, 'mcp-server-docker'],
        'env': {}
      }
    }) -%}
  {%- endif -%}
{%- endfor -%}
{%- for server in servers %}
    "{{ server.name }}": {{ server.config | to_nice_json }}{{ "," if not loop.last else "" }}
{%- endfor %}
  }
}
